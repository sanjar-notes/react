"use strict";(self.webpackChunkreactjs_notes_docu=self.webpackChunkreactjs_notes_docu||[]).push([[7993],{9613:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var a=n(9496);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),s=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",f={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),d=s(n),p=r,m=d["".concat(l,".").concat(p)]||d[p]||f[p]||o;return n?a.createElement(m,i(i({ref:t},u),{},{components:n})):a.createElement(m,i({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=p;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c[d]="string"==typeof e?e:r,i[1]=c;for(var s=2;s<o;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},9032:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>f,frontMatter:()=>o,metadata:()=>c,toc:()=>s});var a=n(1163),r=(n(9496),n(9613));const o={},i="110. useEffect hook",c={unversionedId:"home/resource_itineraries/React_the_complete_guide/side-effects,_reducers,_contextAPI/useEffect_hook",id:"home/resource_itineraries/React_the_complete_guide/side-effects,_reducers,_contextAPI/useEffect_hook",title:"110. useEffect hook",description:"Created Tuesday 08 March 2022",source:"@site/docs/home/4_resource_itineraries/2_React_the_complete_guide/10_side-effects,_reducers,_contextAPI/110_useEffect_hook.md",sourceDirName:"home/4_resource_itineraries/2_React_the_complete_guide/10_side-effects,_reducers,_contextAPI",slug:"/home/resource_itineraries/React_the_complete_guide/side-effects,_reducers,_contextAPI/useEffect_hook",permalink:"/docs/home/resource_itineraries/React_the_complete_guide/side-effects,_reducers,_contextAPI/useEffect_hook",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/home/4_resource_itineraries/2_React_the_complete_guide/10_side-effects,_reducers,_contextAPI/110_useEffect_hook.md",tags:[],version:"current",sidebarPosition:110,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"107. Controlled and uncontrolled components",permalink:"/docs/home/resource_itineraries/React_the_complete_guide/Fragments,_Portals,_Refs/controlled_vs_uncontrolled_components"},next:{title:"114. useEffect cleanup function",permalink:"/docs/home/resource_itineraries/React_the_complete_guide/side-effects,_reducers,_contextAPI/useEffect_cleanup_function"}},l={},s=[{value:"What is an effect, aka &quot;side effect&quot;?",id:"what-is-an-effect-aka-side-effect",level:4},{value:"Why",id:"why",level:3},{value:"How",id:"how",level:3},{value:"Note on dependency array",id:"note-on-dependency-array",level:6},{value:"What",id:"what",level:3},{value:"When to use <code>useEffect</code>?",id:"when-to-use-useeffect",level:6}],u={toc:s},d="wrapper";function f(e){let{components:t,...n}=e;return(0,r.kt)(d,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"110-useeffect-hook"},"110. useEffect hook"),(0,r.kt)("p",null,"Created Tuesday 08 March 2022"),(0,r.kt)("ul",{className:"contains-task-list"},(0,r.kt)("li",{parentName:"ul",className:"task-list-item"},(0,r.kt)("input",{parentName:"li",type:"checkbox",checked:!0,disabled:!0})," ","in vault")),(0,r.kt)("h4",{id:"what-is-an-effect-aka-side-effect"},'What is an effect, aka "side effect"?'),(0,r.kt)("p",null,"The main job of React is to:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Render UI"),(0,r.kt)("li",{parentName:"ol"},"React to user input.")),(0,r.kt)("p",null,'Tasks other than these 2 are "side effects". Example - HTTP requests, DOM manipulation, computation, timers, using ',(0,r.kt)("inlineCode",{parentName:"p"},"localStorage"),", listening to user input etc. Note that some normal ops can also be considered side-effects - like listening to user input for validation."),(0,r.kt)("h3",{id:"why"},"Why"),(0,r.kt)("p",null,'Side effects should not be coded "as is" into the component function, because:'),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"They'll be executed each time the after component is rendered, i.e. after function is executed. This may be very expensive, or not needed."),(0,r.kt)("li",{parentName:"ul"},"If the side effects change state (using ",(0,r.kt)("inlineCode",{parentName:"li"},"useState"),"), then this will trigger an infinite loop. How: ",(0,r.kt)("inlineCode",{parentName:"li"},"side-effect")," --\x3e ",(0,r.kt)("inlineCode",{parentName:"li"},"change state")," --\x3e ",(0,r.kt)("inlineCode",{parentName:"li"},"re-render due to change state")," --\x3e ",(0,r.kt)("inlineCode",{parentName:"li"},"side-effect")," \ud83d\udd01 and so on.")),(0,r.kt)("p",null,"So how do we code side effects into components, in a controllable way. The answer is the ",(0,r.kt)("inlineCode",{parentName:"p"},"useEffect")," hook."),(0,r.kt)("h3",{id:"how"},"How"),(0,r.kt)("p",null,"Syntax of ",(0,r.kt)("inlineCode",{parentName:"p"},"useEffect"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"import {useEffect} from 'react';\n\nconst MyComponent() {\n    ...\n    useEffect( () => {...}, [...]);\n    ...\n    return <>...</>;\n}\n")),(0,r.kt)("p",null,"It has two pieces:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Dependency array - just variables. React keeps track of these."),(0,r.kt)("li",{parentName:"ol"},"A function that runs ",(0,r.kt)("em",{parentName:"li"},"after")," every render if any dependencies have changed, including after the first render (independent of dependency array). Side effect code goes into this function.")),(0,r.kt)("h6",{id:"note-on-dependency-array"},"Note on dependency array"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"If dependency = ",(0,r.kt)("inlineCode",{parentName:"li"},"undefined"),", i.e. absent. Function will run after every render."),(0,r.kt)("li",{parentName:"ol"},"If dependency = [] (empty array), the function will execute once, i.e. after first render."),(0,r.kt)("li",{parentName:"ol"},"If the dependency array has any candidates, the function will run after every render, given the dependencies have changed."),(0,r.kt)("li",{parentName:"ol"},"In-built functions, second element of ",(0,r.kt)("inlineCode",{parentName:"li"},"useState()")," array, or anything defined outside the component should not be passed as a dependency, because it has no effect. Basically, only pass stuff that is changed/can change inside the component function (or its parent).")),(0,r.kt)("h3",{id:"what"},"What"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"useEffect")," is the solution to the problem of placement (and therefore execution) of side-effect (s) code."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"useEffect")," is not like ",(0,r.kt)("inlineCode",{parentName:"li"},"useState"),". i.e. it won't trigger re-render due dependency array change. It will do so only if state is changed using ",(0,r.kt)("inlineCode",{parentName:"li"},"set")," of ",(0,r.kt)("inlineCode",{parentName:"li"},"useState")," inside the function, which is not the question here. Again, to reiterate - ",(0,r.kt)("inlineCode",{parentName:"li"},"useEffect")," runs the function after every render if any dependency has changed."),(0,r.kt)("li",{parentName:"ul"},"Additionally, ",(0,r.kt)("inlineCode",{parentName:"li"},"useEffect")," may be used as a refactor to repeated code, due to presence of a dependency array.")),(0,r.kt)("h6",{id:"when-to-use-useeffect"},"When to use ",(0,r.kt)("inlineCode",{parentName:"h6"},"useEffect"),"?"),(0,r.kt)("p",null,"It should be used whenever you feel like running 3 life-cycle hooks, namely:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"componentDidMount")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"componentDidUpdate")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"componentWillUnmount"),"\nSee ",(0,r.kt)("a",{parentName:"li",href:"https://blog.logrocket.com/guide-to-react-useeffect-hook/"},"this")," for details. FIXME: refactor useEffect pages (this and the next page).")),(0,r.kt)("p",null,"Some common situations:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"The task is a side-effect. Note that all possible side-effect code is a part of ",(0,r.kt)("inlineCode",{parentName:"li"},"useEffect"),", i.e. ",(0,r.kt)("inlineCode",{parentName:"li"},"useEffect")," is for side-effects, the converse may not be true."),(0,r.kt)("li",{parentName:"ol"},"It is computationally expensive and/or not needed on each render."),(0,r.kt)("li",{parentName:"ol"},"For http requests, DB/",(0,r.kt)("inlineCode",{parentName:"li"},"localStorage")," read/writes may use ",(0,r.kt)("inlineCode",{parentName:"li"},"useEffect"),".")))}f.isMDXComponent=!0}}]);