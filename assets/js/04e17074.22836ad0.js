"use strict";(self.webpackChunkreactjs_notes_docu=self.webpackChunkreactjs_notes_docu||[]).push([[2674],{9613:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>h});var n=a(9496);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),l=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},d=function(e){var t=l(e.components);return n.createElement(s.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,d=c(e,["components","mdxType","originalType","parentName"]),p=l(a),m=r,h=p["".concat(s,".").concat(m)]||p[m]||u[m]||i;return a?n.createElement(h,o(o({ref:t},d),{},{components:a})):n.createElement(h,o({ref:t},d))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=m;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c[p]="string"==typeof e?e:r,o[1]=c;for(var l=2;l<i;l++)o[l]=a[l];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},2955:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var n=a(1163),r=(a(9496),a(9613));const i={},o="242. Adding state slices",c={unversionedId:"home/resource_itineraries/React_the_complete_guide/Redux/React_Toolkit_working",id:"home/resource_itineraries/React_the_complete_guide/Redux/React_Toolkit_working",title:"242. Adding state slices",description:"Created Saturday 30 July 2022",source:"@site/docs/home/4_resource_itineraries/2_React_the_complete_guide/18_Redux/242_React_Toolkit_working.md",sourceDirName:"home/4_resource_itineraries/2_React_the_complete_guide/18_Redux",slug:"/home/resource_itineraries/React_the_complete_guide/Redux/React_Toolkit_working",permalink:"/reactjs-notes/docs/home/resource_itineraries/React_the_complete_guide/Redux/React_Toolkit_working",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/home/4_resource_itineraries/2_React_the_complete_guide/18_Redux/242_React_Toolkit_working.md",tags:[],version:"current",sidebarPosition:242,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"241. Redux challenges and Introducing Redux Toolkit",permalink:"/reactjs-notes/docs/home/resource_itineraries/React_the_complete_guide/Redux/Redux_challenges_and_Introducing_Redux_Toolkit"},next:{title:"230.1. Core Redux with React",permalink:"/reactjs-notes/docs/home/resource_itineraries/React_the_complete_guide/Redux/230_1_Core_Redux_with_React"}},s={},l=[{value:"Working with RTK",id:"working-with-rtk",level:3},{value:"Questions",id:"questions",level:3}],d={toc:l},p="wrapper";function u(e){let{components:t,...a}=e;return(0,r.kt)(p,(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"242-adding-state-slices"},"242. Adding state slices"),(0,r.kt)("p",null,"Created Saturday 30 July 2022"),(0,r.kt)("p",null,"To work with React Toolkit, a React project needs two packages:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"@reduxjs/toolkit")," - contains core ",(0,r.kt)("inlineCode",{parentName:"li"},"redux")," and extra functionality"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"react-redux")," - React bindings for providing and consuming store state.")),(0,r.kt)("p",null,"Note: remove npm package ",(0,r.kt)("inlineCode",{parentName:"p"},"redux")," from ",(0,r.kt)("inlineCode",{parentName:"p"},"package.json")," if present, because it's already present in using ",(0,r.kt)("inlineCode",{parentName:"p"},"@reduxjs/toolkit"),". ",(0,r.kt)("inlineCode",{parentName:"p"},"import")," from ",(0,r.kt)("inlineCode",{parentName:"p"},"redux")," to create store is still valid, although there may be no Intellisense now. It is generally not used when using RTK."),(0,r.kt)("h3",{id:"working-with-rtk"},"Working with RTK"),(0,r.kt)("p",null,"There are 5 constructs when working with RTK:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Slices - these are combined by RTK to create the whole store. Their function is to separate out reducers and parts of store relevant to a feature. "),(0,r.kt)("p",{parentName:"li"},"The ",(0,r.kt)("inlineCode",{parentName:"p"},"createSlice")," function takes an object with attributes ",(0,r.kt)("inlineCode",{parentName:"p"},"name")," which is a string, ",(0,r.kt)("inlineCode",{parentName:"p"},"initialState")," which is an object, and a ",(0,r.kt)("inlineCode",{parentName:"p"},"reducers"),"(",(0,r.kt)("strong",{parentName:"p"},"plural"),") which is an object of reducer functions.\nA slice is created like so:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"import { createSlice } from '@reduxjs/toolkit';\n\nconst authInitialState = { isAuthenticated: false };\n\nconst authSlice = createSlice({\n    name: 'auth', // can be named anything, isn't used elsewhere\n    initialState: authInitialState,\n    reducers: {\n        login: (state) => (state.isAuthenticated = true),\n        logout: (state) => (state.isAuthenticated = false),\n        checkPassword: (state, action) => (state.existingPassword === action.payload.password)\n    }\n})\n")),(0,r.kt)("p",{parentName:"li"},"A slice combines all specified reducers into a ",(0,r.kt)("em",{parentName:"p"},"single")," reducer accessible via the ",(0,r.kt)("inlineCode",{parentName:"p"},"reducer")," (",(0,r.kt)("strong",{parentName:"p"},"singular"),") attribute. This reducer is usually exported from the slice file (yes, slices are kept in individual files)."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"export default authSlice.reducer;\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Creating the store - the store is created by combining all the reducers (available in the slices), using the ",(0,r.kt)("inlineCode",{parentName:"p"},"configureStore")," function available in RTK. Note: the ",(0,r.kt)("inlineCode",{parentName:"p"},"configureStore")," param is an object with the attribute of ",(0,r.kt)("inlineCode",{parentName:"p"},"reducer")," (",(0,r.kt)("strong",{parentName:"p"},"singular"),")."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"import { configureStore } from '@reduxjs/toolkit';\n\nconst authSlice = /**/ ;\nconst counterSlice = /**/ ;\n\nconst store = configureStore({\n    reducer: { counter: counterSlice.reducer, auth: authSlice.reducer }\n});\n\nexport default store;\n")),(0,r.kt)("p",{parentName:"li"},"The ",(0,r.kt)("inlineCode",{parentName:"p"},"configureStore.reducer")," object's keys ",(0,r.kt)("strong",{parentName:"p"},"don't")," have to match the slice name, but they are generally kept the same. But the key is important and used elsewhere."),(0,r.kt)("p",{parentName:"li"},"If there's just a single store, the ",(0,r.kt)("inlineCode",{parentName:"p"},"configureStore.reducer")," can be set to the reducer directly. Like so:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"const store = configureStore({ reducer: counterSlice.reducer }); // also OK\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Actions - unlike core ",(0,r.kt)("inlineCode",{parentName:"p"},"redux"),", actions strings are not specified by us. RTK action objects which contain unique ",(0,r.kt)("inlineCode",{parentName:"p"},"action.type")," strings. The set of actions available to a slice can be accessed from the slice. These are kept in the slice file, and generally exported where a dispatch needs to be done. Example:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"export const authActions = authSlice.actions;\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Providing the store - same as before, i.e. by wrapping the React ancestor with ",(0,r.kt)("inlineCode",{parentName:"p"},"react-redux"),"'s ",(0,r.kt)("inlineCode",{parentName:"p"},"<Provider store={}></Provider>"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Consuming the store data - mostly the same as without RTK, i.e. using the ",(0,r.kt)("inlineCode",{parentName:"p"},"useSelector")," hook. The difference is that the data relevant to a slice is actually kept in that slice, and needs to be accessed by the name of slice (specified during slice creation). Example:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"// suppose the relevant slices names' are 'counter' and 'auth'\nimport { useSelector } from 'react-redux';\nfunction MyComponent() {\n    const count = useSelector(state => state.counter.count); // instead of state.count\n    const authenticated = useSelector(state => state.auth.isAuthenticated);\n\n    return /**/;\n}\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Dispatch - dispatch are still done using ",(0,r.kt)("inlineCode",{parentName:"p"},"useDispatch"),". The only difference is the way we specify actions. Actions are first accessed from the slice using the ",(0,r.kt)("inlineCode",{parentName:"p"},"actions")," attribute. Then we call a particular action function as per it's name specified in the reducer object of the slice. Note: the action function should be called to generate the action."),(0,r.kt)("p",{parentName:"li"},"We can pass action data to by passing the data directly in the action function. This will be made available an attribute named ",(0,r.kt)("inlineCode",{parentName:"p"},"payload")," in the action object received by the reducer."),(0,r.kt)("p",{parentName:"li"},"Code example:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"import { useDispatch } from 'react-redux';\nimport { authActions } from '../auth';\n\nfunction MyComponent() {\n    const dispatch = useDispatch();\n    \n    const loginHandler = () => dispatch(authActions.login());\n    const passwordHandler = (event) => dispatch(authActions.passwordCheck(event.target.value));\n\n    return /**/;\n}\n")))),(0,r.kt)("p",null,"Note:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Name of the slice and name of the slice reducer in ",(0,r.kt)("inlineCode",{parentName:"li"},"configureStore.reducer")," key don't have to match. See ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/exemplar-codes/react-redux-demo/commit/8a09aa87c7c538848d12bcc0774e9c064b6db451"},"code"),"."),(0,r.kt)("li",{parentName:"ol"},"When accessing store data using ",(0,r.kt)("inlineCode",{parentName:"li"},"useSelector"),", the key of the callback param must match the slice reducer name. If there's only one reducer passed directly to ",(0,r.kt)("inlineCode",{parentName:"li"},"configureStore"),", the data is directly accessible. See ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/exemplar-codes/react-redux-demo/commit/d5ca4e7de8525e6a536506f6ff5f29e61acefc2e#diff-5541be143e3e2a0dcdfefeb9ca7c2ac4cb3eb7965e000bd10669f31f125755cf"},"code"),"."),(0,r.kt)("li",{parentName:"ol"},"All data passed to the action creator during dispatch is made available as ",(0,r.kt)("inlineCode",{parentName:"li"},"payload")," in attribute of the action in the slice reducer."),(0,r.kt)("li",{parentName:"ol"},"Every attribute ",(0,r.kt)("inlineCode",{parentName:"li"},"reducer")," is singular at all places except during slice creation, where it's plural."),(0,r.kt)("li",{parentName:"ol"},"Store drilling w.r.t slice reducer name is there only when consuming store data, not in the slice's ",(0,r.kt)("inlineCode",{parentName:"li"},"reducers"),"."),(0,r.kt)("li",{parentName:"ol"},"Slices are kept in different files, and only the slice's action creators object and reducer are exported, since they're needed during dispatch and store creation, respectively.")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"See ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/exemplar-codes/react-redux-demo/commit/1546db08861125733265e11773d1909acf3fc30c"},"code")," for this whole page."),(0,r.kt)("li",{parentName:"ul"},"RTK with class based components is also ",(0,r.kt)("a",{parentName:"li",href:"/reactjs-notes/docs/home/resource_itineraries/React_the_complete_guide/Redux/Redux_with_React_for_class_components"},"easy"),", because all needed functions ",(0,r.kt)("inlineCode",{parentName:"li"},"connect"),", ",(0,r.kt)("em",{parentName:"li"},"mapStateToProps")," and ",(0,r.kt)("em",{parentName:"li"},"mapDispatchToProps")," are all still part of ",(0,r.kt)("inlineCode",{parentName:"li"},"react-redux")," package. See ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/exemplar-codes/react-redux-demo/commit/7c8c403f547abeaf542ff73cb052e1dd46db04a2"},"code"),".")),(0,r.kt)("h3",{id:"questions"},"Questions"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Can a reducer in a slice access values from another slice? No, each reducer can access only slice in it's data. If two slices wish to use each other's data, they should be combined into a single slice OR one can do some acrobatics to get reducers to share data."),(0,r.kt)("li",{parentName:"ol"},"Can two slices have data with the same name? Yes, there's no scope of collision as reducers are confined to their own slices. This may cause confusion amongst developers of the project, though. See ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/exemplar-codes/react-redux-demo/commit/8d2ef9f3838979384acec94cb51cf64bfcaff0ca"},"code"),".")))}u.isMDXComponent=!0}}]);