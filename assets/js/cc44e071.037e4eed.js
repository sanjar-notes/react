"use strict";(self.webpackChunkreactjs_notes_docu=self.webpackChunkreactjs_notes_docu||[]).push([[2384],{9613:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var o=n(9496);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=o.createContext({}),l=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=l(e.components);return o.createElement(c.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=l(n),m=a,h=u["".concat(c,".").concat(m)]||u[m]||d[m]||r;return n?o.createElement(h,i(i({ref:t},p),{},{components:n})):o.createElement(h,i({ref:t},p))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=m;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[u]="string"==typeof e?e:a,i[1]=s;for(var l=2;l<r;l++)i[l]=n[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4437:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var o=n(1163),a=(n(9496),n(9613));const r={},i="122. Using React Context API",s={unversionedId:"home/resource_itineraries/React_the_complete_guide/side-effects,_reducers,_contextAPI/Using_React_Context_API",id:"home/resource_itineraries/React_the_complete_guide/side-effects,_reducers,_contextAPI/Using_React_Context_API",title:"122. Using React Context API",description:"Created Tuesday 14 March 2022",source:"@site/docs/home/4_resource_itineraries/2_React_the_complete_guide/10_side-effects,_reducers,_contextAPI/122_Using_React_Context_API.md",sourceDirName:"home/4_resource_itineraries/2_React_the_complete_guide/10_side-effects,_reducers,_contextAPI",slug:"/home/resource_itineraries/React_the_complete_guide/side-effects,_reducers,_contextAPI/Using_React_Context_API",permalink:"/reactjs-notes/docs/home/resource_itineraries/React_the_complete_guide/side-effects,_reducers,_contextAPI/Using_React_Context_API",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/home/4_resource_itineraries/2_React_the_complete_guide/10_side-effects,_reducers,_contextAPI/122_Using_React_Context_API.md",tags:[],version:"current",sidebarPosition:122,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"121. Introducing React Context (Context_API)",permalink:"/reactjs-notes/docs/home/resource_itineraries/React_the_complete_guide/side-effects,_reducers,_contextAPI/Introducing_React_Context_(Context_API)"},next:{title:"123. Context Limitations",permalink:"/reactjs-notes/docs/home/resource_itineraries/React_the_complete_guide/side-effects,_reducers,_contextAPI/Context_Limitations"}},c={},l=[{value:"Why",id:"why",level:3},{value:"How",id:"how",level:3},{value:"Details of using React Context",id:"details-of-using-react-context",level:6},{value:"What",id:"what",level:3},{value:"Architectural style for context",id:"architectural-style-for-context",level:3}],p={toc:l},u="wrapper";function d(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"122-using-react-context-api"},"122. Using React Context API"),(0,a.kt)("p",null,"Created Tuesday 14 March 2022"),(0,a.kt)("ul",{className:"contains-task-list"},(0,a.kt)("li",{parentName:"ul",className:"task-list-item"},(0,a.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","in vault")),(0,a.kt)("h3",{id:"why"},"Why"),(0,a.kt)("p",null,"Passing props or lifting state visibly is not good, better use a component-wide state."),(0,a.kt)("h3",{id:"how"},"How"),(0,a.kt)("p",null,"The 3 steps when using the Context API, obviously (logically), are:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Create")," the context. This is done in a standalone file."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Provide")," the context at the appropriate place (component). It's made available to all descendants of the selected root component. Remember to ",(0,a.kt)("strong",{parentName:"li"},"specify")," the context value (object) at this stage."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Consume")," the context. Of course in a descendant. ",(0,a.kt)("em",{parentName:"li"},"Consuming the context outside of the Provider is not possible (really important - because React does not raise an error when you do this, which leads to silent bugs)."))),(0,a.kt)("p",null,"Note: Both the provider and consumer are generated from the context. Remembering this makes it very easy to remember the whole syntax of context API."),(0,a.kt)("p",null,"There are two ways of consuming Context:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Using the ",(0,a.kt)("inlineCode",{parentName:"li"},"Consumer")," component. This just looks a tad ugly."),(0,a.kt)("li",{parentName:"ol"},"Using the ",(0,a.kt)("inlineCode",{parentName:"li"},"useContext")," hook. Looks better.")),(0,a.kt)("h6",{id:"details-of-using-react-context"},"Details of using React Context"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"To ",(0,a.kt)("strong",{parentName:"li"},"Create")," the context, make a React component named something like 'context'. This is done in separate a JavaScript file. It's recommended to store this in a folder called 'store'.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import React from 'react';\n\nconst AuthContext = React.createContext({});\n\nexport default AuthContext;\n")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"To ",(0,a.kt)("strong",{parentName:"p"},"provide"),", or place the store at the place of use - import and wrap the provider component (i.e. ContextComponent.",(0,a.kt)("inlineCode",{parentName:"p"},"Provider"),") around the ancestor component. This specifies that the context will be available to all descendants, and the ancestor will re-render if any change occurs in the context."),(0,a.kt)("p",{parentName:"li"},"Remember to provide the context object here as a ",(0,a.kt)("inlineCode",{parentName:"p"},"value"),"."))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"import React, { useState } from 'react';\n\nimport AuthContext from './path_to_auth-context';\n\nconst AppCommonAncestor = () => {\n    const [val, setVal] = useState(0);\n    \n    return (<AuthContext.Provider value={{val, setVal}}> \n            {/* code as usual */}\n            </AuthContext.Provider>);\n};\n")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"To consume the context, import the context component and use the ",(0,a.kt)("inlineCode",{parentName:"li"},"useContext")," hook. Using the hook actually provides a read only",(0,a.kt)("span",{title:"write is achieved using functions, similar to lifting state up"},"*")," copy of the context, so that re-renders are possible (from the first ancestor).")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"import React from 'react';\n\nimport AuthContext from './path_to_auth-context';\n\nimport AppComponent = () => {\n    const ctx = useContext(AuthContext);\n    \n    return (<>\n            { \n            // can read ctx. writing is done by function invocation\n            }\n            </>);\n};\n")),(0,a.kt)("p",null,"Note: There's another way to consume context - just wrap the consuming component's code by the Context.",(0,a.kt)("inlineCode",{parentName:"p"},"Consumer"),". This is equivalent to using the hook, but looks bad."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"import React from 'react';\n\nimport AuthContext from './path_to_auth-context';\n\nimport AppComponent = () => {\n    return (<AuthContext.Consumer>\n            { \n                (ctx) => {\n                    // can read ctx. writing is done by function invocation\n                    }\n            }\n            </AuthContext.Consumer>);\n};\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Tip"),": For better IDE auto-completion, just add some attributes (called default context) in the context component."),(0,a.kt)("h3",{id:"what"},"What"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"React context is thus a way to have a global state across components.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"The hook provides a read only object for each user(consumer component). A write re-renders the ancestor component, effectively re-rendering all descendant components.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"One should absolutely use ",(0,a.kt)("inlineCode",{parentName:"p"},"useState"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"useEffect"),' at the component where context is "Provided", for persistence and automatic re-renders, of course by adding the ',(0,a.kt)("inlineCode",{parentName:"p"},"useState")," variables to the context. FIXME: is ",(0,a.kt)("inlineCode",{parentName:"p"},"useState")," even required if writing to context already causes re-render?")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"One must be careful to not use context for reusable components, which must use props (which are basically arguments for them).")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"So use context only when there's lot of plumbing needed AND the components involved are ",(0,a.kt)("em",{parentName:"p"},"specific"),"(i.e. not reused).")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Context component(s) and the store folder are nice way to handle all data within the app, in a dedicated place."))),(0,a.kt)("h3",{id:"architectural-style-for-context"},"Architectural style for context"),(0,a.kt)("p",null,'There are two ways to write code when using context - because "context by default does not contain state":'),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Have a file containing the context, and specify the ",(0,a.kt)("inlineCode",{parentName:"p"},"Provider")," ",(0,a.kt)("inlineCode",{parentName:"p"},"value"),' separately at the "root" (ancestor) of the UI subset. The stateful logic, in this case is specified at the "root" component, a core UI component. Note that all context is accessible within this "root" component.'),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"// FoodContext.js\nconst FoodContext = React.createContext({});\nexport default FoodContext;\n")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"// FoodRoot.jsx\nimport FoodContext from './store_path/FoodContext';\n\nfunction FoodRoot () {\n    // the UI subset tree's state logic start\n    const [count, setCount] = useState(0);\n    // state logic end\n\n    return \n    (\n        <FoodContext.Provider value={{count, setCount}}>\n            ... \x3c!-- can use count, setCount here --\x3e\n        </FoodContext.Provider>\n    );\n}\nexport default FoodRoot;\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Have a single file to specify both the context and ",(0,a.kt)("inlineCode",{parentName:"p"},"Provider")," ",(0,a.kt)("inlineCode",{parentName:"p"},"value")," , then export both (use ",(0,a.kt)("inlineCode",{parentName:"p"},"props.children"),' for the Provider being exported). Essentially, all context (including state logic) resides in the context file, and not in any core UI component. Note that the context is not available at the "Provider" component ("FoodRoot.jsx" here).'),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"// FoodContext.js\nconst FoodContext = React.createContext({});\n\nfunction FoodContextProvider() {\n    const [count, setCount] = useState(0); // have state logic here\n\n    return \n    (\n        <FoodContext.Provider value={{count, setCount}}>\n            {props.children /* IMPORTANT */}\n        </FoodContext.Provider>\n    );\n}\n\nexport default FoodContext;\nexport { FoodContextProvider };\n")),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"// FoodRoot.jsx\nimport { FoodContextProvider } from './store_path/FoodContext';\n\nfunction FoodRoot () {\n    return \n    (\n        <FoodContextProvider>\n            ... \x3c!-- CANNOT use count, setCount directly here --\x3e\n        </FoodContextProvider>\n    );\n}\nexport default FoodRoot;\n")))),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Note that both styles don't affect the consumption of the context in any way, and that we still need to export the context."),(0,a.kt)("li",{parentName:"ul"},'What to use? Well both have their pros and cons. In case 1, context is available in the "Provider" component, but not in case 2. The con of case 1 is that the Provider is clogged with context details, which may be removed from it and placed in the context, to make the code lean.')))}d.isMDXComponent=!0}}]);