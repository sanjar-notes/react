# 302. What, How and Why?
Created Monday 31 October 2022

## Why
Security


## What
- Authentication just means signup/login.
- Technically, authentication is a way to restrict access to resources. 
- In web apps, it's used to restrict access to pages (via links) or data (via API requests to our server).
Example - email login, bank account login, or any other login for that matter.


## How
Assuming we have our user account already made, the authentication process is simple:
1. Login - send login _credentials_ which the server can verify. If we provide correct credentials, we get some unique _data_ generated by the server.
2. Access - this "data" (from step 1) is added to all subsequent requests to the server, in order to access protected content.

Note that from an app functionality point of view, the only thing that matters is _access_ (step 2 with or without "data"). But if step 2 doesn't have "data", it could be by anyone, which is not secure. Step 1 (login) establishes security of step 2 (access).


## Implementation approaches for web authentication
Two approaches are:
1. **Server-side sessions** - on login, i.e. successful credential verification of a client, the server generates, stores and sends back a "session data" to the client. This "data" is sent (along with the request payload) by the client and verified (basic equality check) by the server for all subsequent requests. The server may regenerate this "session data" at any time, but this doesn't affect the flow at all.
2. **Authentication tokens** - uses authentication property of asymmetric encryption. On login, i.e. successful credential verification of a client, the server generates and sends back a "token" to the client. BUT, it does not store the "token". This "token" is sent (along with the request payload) by the client and verified (using ~public private key match) by the server for all subsequent requests. The server may regenerate this "token" at any time, but this doesn't affect the flow at all.

1 is suitable if all requests (SPA/pages, content, data) are made to the same server. But if an app uses multiple servers (decoupled backend), then it's not so suitable (Why?? the client can have multiple server-side tokens, one for each server).

What to do - all backend services should be decoupled from each other (WTF? That's what I wrote above!)

FIXME: server-side sessions and authentication tokens use equality(symmetric) and asymmetric encryption for security. They have nothing to do with coupled, decoupled backends! See [this](https://dev.to/thecodearcher/what-really-is-the-difference-between-session-and-token-based-authentication-2o39#:~:text=both%20methods%20can%20be%20used%20interchangeably%20or%20together%20to%20create%20a%20hybrid%20system.%20).


### Comparison
- [Fireship - Session vs Token Authentication in 100 Seconds](https://www.youtube.com/watch?v=UBUNrFtufWo&ab_channel=Fireship)
- Session approach will need the server to be stateful (i.e. store session files), while tokens don't have any server overhead (storage).
- Session approach allows for individually (based on user info) set session parameters, while tokens are more general.


### Vulnerability
An attacker can easily impersonate a legitimate user stealing the "session data/auth token", or in CSRF, XSS attacks. Sessions are protected from CSRF by most frontend libraries/frameworks.