# 230. Core Redux
Created Friday 29 July 2022

Core Redux is the npm package "redux".
Code: https://github.com/exemplar-codes/redux-demo

#### Constructs
There are 4 constructs in core Redux:
1. Store
2. Reducer
3. Subscribers, if any.
4. Dispatch calls


#### Details
1. Reducer - this is a function that takes in 2 parameters, latest state and something called "action". The "action" is the same as argument passed to the dispatch function. It must must return the new state. Note:
	1. DO NOT mutate the state directly, this can cause unforeseen bugs. Instead return a copy of the new state.
	2. It must return the complete state, as redux *will not* merge the returned object with the state, i.e. behaves exactly like `React.useState`.
2. Store - this is created using `redux.createStore(reducerFunc)`, takes reducer as the first argument. It has the following attributes:
	1. `store.latestState()` - latest snapshot of the store.
	2. `store.dispatch` - can dispatch to cause store mutation
	3. `store.subscribe(callback)` - subscribe to the store via callback.
	
		Store initialization is not a part of core Redux. Store initialization is done indirectly by calling the reducer when the store is first created, so initialization logic is part of the reducer. 
	
		Note: For this first reducer call, "action" argument is generated by Redux, and state is `undefined`. Because state is `undefined` only for the first time, store initialization can be done by using a default argument in the reducer. Like so:
		```js
		const initialState = {count: 0};
		const reducer = (state=initialState, action) => {};
		```
3. Subscribers - callbacks without any parameter. Subscribed using `store.subscribe`, triggered on store change. Subscriptions are optional. There can be multiple subscriptions.
4. Dispatch call - using `store.dispatch`, the first argument (aka "action") will be made available as-is to the reducer as its second param. The "action" may be of any data type, but it is generally an object carrying a "type" string field and an optional "payload" variable.

#### Code sample
```js
const {createStore} from 'redux';

const initialState = {count: 0, showCount: true}; // 0 initialization

const reducer = (state = initalState, action) => { // 1. Reducer
	switch(action.type) {
		case 'INCREMENT':
			return {...state, count: state.count + 1};
			break;
			
		case 'DECREMENT':
			return {...state, count: state.count - 1};
			break;
			
		case 'INCREASE_BY':
			return {...state, count: state.count + action.delta};
			break;
			
		case 'TOGGLE':
			return {...state, showCount: !state.showCount};
			break;
	}

	return state; // works for both initialization and wrong dispatch
}
	
const store = createStore(reducer); // 2. Store creation

store.dispatch({type: 'INCREMENT'}); // 3. Dispatch
store.dispatch({type: 'INCREASE_BY', delta: 20});


function subscriberCallback = () => console.log('Store mutated!');

store.subscribe(subscriberCallback); // 4. subscription
```